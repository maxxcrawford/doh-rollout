[
  {
    "namespace": "experiments.heuristics",
    "description": "Heuristics for disabling DNS-over-HTTPS (DoH)",
    "functions": [
      {
        "name": "setupTelemetry",
        "type": "function",
        "description": "Sets up the Telemetry for the addon",
        "parameters": [
        ],
        "async": false
      },
      {
        "name": "sendHeuristicsPing",
        "type": "function",
        "description": "Sends a ping for the results of the heuristics",
        "parameters": [
          { 
            "name": "decision",
            "type": "string"
          },
          {
            "name": "results",
            "type": "object",
            "properties": {
              "google": {
                "description": "Indicates whether Google safe-search is enabled",
                "type": "string"
              },
              "youtube": {
                "description": "Indicates whether YouTube safe-search is enabled",
                "type": "string"
              },
              "comcastProtect": {
                "description": "Indicates whether Comcast's malware filter is enabled",
                "type": "string"
              },
              "comcastParent": {
                "description": "Indicates whether Comcast's parental controls are enabled",
                "type": "string"
              },
              "canary": {
                "description": "Indicates whether global canary domain was filtered",
                "type": "string"
              },
              "modifiedRoots": {
                "description": "Indicates whether enterprise roots are enabled",
                "type": "string"
              },
              "browserParent": {
                "description": "Indicates whether browser has enabled parental controls",
                "type": "string"
              },
              "policy": {
                "description": "Indicates whether browser policy blocks DoH",
                "type": "string"
              },
              "evaluateReason": {
                "description": "Reason why we are running heuristics, e.g. startup",
                "type": "string"
              }
            }
          }
        ],
        "async": false
      },
      {
        "name": "sendDoorhangerPing",
        "type": "function",
        "description": "Sends a ping for interactions with the doorhanger",
        "parameters": [
          {
            "name": "reason",
            "type": "string"
          }
        ],
        "async": false
      },
      {
        "name": "checkEnterprisePolicies",
        "type": "function",
        "description": "Checks for enterprise policies",
        "parameters": [
        ],
        "async": true
      },
      {
        "name": "checkParentalControls",
        "type": "function",
        "description": "Checks for browser-based parental controls",
        "parameters": [
        ],
        "async": true
      }
    ]
  }
]
